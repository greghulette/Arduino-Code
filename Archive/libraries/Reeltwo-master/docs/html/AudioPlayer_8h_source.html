<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ReelTwo: audio/AudioPlayer.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="reeltwo.css" rel="stylesheet" type="text/css">
<!--  -->
<script type="text/javascript" src="reeltwo_navtree.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="R2BGlogo_black.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"><a href="http://reeltwo.github.com">ReelTwo</a>
   </div>
   <div id="projectbrief">RSeries astromech firmware</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('AudioPlayer_8h_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">AudioPlayer.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="AudioPlayer_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Audio.h</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *  Created on: Oct 26,2018</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *  Updated on: Feb 10,2021</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *      Author: Wolle (schreibfaul1)   ¯\_(ツ)_/¯</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160; </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#if !defined(ESP32)</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#error Only supports ESP32</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#ifndef AudioPlayer_h_</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#define AudioPlayer_h_</span></div>
<div class="line"><a name="l00015"></a><span class="lineno"><a class="line" href="AudioPlayer_8h.html#a95aeacb103bd1c4e03b3e154e450c534">   15</a></span>&#160;<span class="preprocessor">#define FF_LFN_UNICODE      2</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;Arduino.h&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;base64.h&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;SPI.h&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;SD.h&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;SD_MMC.h&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;SPIFFS.h&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;FS.h&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;FFat.h&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;WiFiClientSecure.h&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;driver/i2s.h&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">// extern __attribute__((weak)) void audio_info(const char*);</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">// extern __attribute__((weak)) void audio_id3data(const char*); //ID3 metadata</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">// extern __attribute__((weak)) void audio_id3image(File&amp; file, const size_t pos, const size_t size); //ID3 metadata image</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">// extern __attribute__((weak)) void audio_eof_mp3(const char*); //end of mp3 file</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">// extern __attribute__((weak)) void audio_showstreamtitle(const char*);</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">// extern __attribute__((weak)) void audio_showstation(const char*);</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">// extern __attribute__((weak)) void audio_bitrate(const char*);</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">// extern __attribute__((weak)) void audio_commercial(const char*);</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">// extern __attribute__((weak)) void audio_icyurl(const char*);</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">// extern __attribute__((weak)) void audio_lasthost(const char*);</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">// extern __attribute__((weak)) void audio_eof_speech(const char*);</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">// extern __attribute__((weak)) void audio_eof_stream(const char*); // The webstream comes to an end</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">//----------------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="classAudioBuffer.html">   42</a></span>&#160;<span class="keyword">class </span><a class="code" href="classAudioBuffer.html">AudioBuffer</a> {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">// AudioBuffer will be allocated in PSRAM, If PSRAM not available or has not enough space AudioBuffer will be</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">// allocated in FlashRAM with reduced size</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">//                      m_readPtr                 m_writePtr                 m_endPtr</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">//                           |&lt;------dataLength-------&gt;|&lt;------ writeSpace -----&gt;|</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">//                           ▼                         ▼                         ▼</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">// ---------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">// |                       &lt;--m_buffSize--&gt;                                      |      &lt;--m_resBuffSize --&gt;     |</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">// ---------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">// |&lt;------freeSpace--------&gt;|                         |&lt;------freeSpace--------&gt;|</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">// if the space between m_readPtr and buffend &lt; 1600 bytes copy data from the beginning to resBuff</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">// so that the mp3 frame is always completed</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">//                               m_writePtr                 m_readPtr        m_endPtr</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">//                                    |&lt;-------writeSpace-1 ---&gt;|&lt;--dataLength--&gt;|</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">//                                    ▼                         ▼                ▼</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">// ---------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">// |                       &lt;--m_buffSize--&gt;                                      |      &lt;--m_resBuffSize --&gt;     |</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">// ---------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">// |&lt;---  ------dataLength--  ------&gt;|&lt;-------freeSpace-------&gt;|</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="classAudioBuffer.html#aba78f7f67592d21765d202c5f73303ba">AudioBuffer</a>();                      <span class="comment">// constructor</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="classAudioBuffer.html#ad0ac8e7a12eebe66c317683d94b3707e">~AudioBuffer</a>();                     <span class="comment">// frees the buffer</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordtype">size_t</span>   <a class="code" href="classAudioBuffer.html#a1cd827716f4f84c3f009bee37d5a5cf4">init</a>(<span class="keywordtype">size_t</span> bufSize = 0);  <span class="comment">// set default values</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordtype">size_t</span>   <a class="code" href="classAudioBuffer.html#aef8f9eb21f4d58339eab5b0e05b27fae">freeSpace</a>();               <span class="comment">// number of free bytes to overwrite</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordtype">size_t</span>   <a class="code" href="classAudioBuffer.html#a7714f5ad92756b53a6f95ca97b6fd8ff">writeSpace</a>();              <span class="comment">// space fom writepointer to bufferend</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordtype">size_t</span>   <a class="code" href="classAudioBuffer.html#a42323ac5a6c5ff9e46eb1c103a5b9630">bufferFilled</a>();            <span class="comment">// returns the number of filled bytes</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordtype">void</span>     <a class="code" href="classAudioBuffer.html#aabaf555275e703fb89bd766c599ec625">bytesWritten</a>(<span class="keywordtype">size_t</span> bw);   <span class="comment">// update writepointer</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordtype">void</span>     <a class="code" href="classAudioBuffer.html#a41f2d6df57df4b4842908ed8465dbd1b">bytesWasRead</a>(<span class="keywordtype">size_t</span> br);   <span class="comment">// update readpointer</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    uint8_t* <a class="code" href="classAudioBuffer.html#a94d2e594082956eb129a9e1407322230">writePtr</a>();                <span class="comment">// returns the current writepointer</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    uint8_t* <a class="code" href="classAudioBuffer.html#a771e25dbef713d81d4e9ffc543405172">readPtr</a>();                 <span class="comment">// returns the current readpointer</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    uint32_t <a class="code" href="classAudioBuffer.html#a4db6ca32d7db0d2d6ed2463e6b28da51">getWritePos</a>();             <span class="comment">// write position relative to the beginning</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    uint32_t <a class="code" href="classAudioBuffer.html#a4c3ac9edee009fefbe8584290d40464c">getReadPos</a>();              <span class="comment">// read position relative to the beginning</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordtype">void</span>     <a class="code" href="classAudioBuffer.html#a16f25a4e620cb6b7b27bc7834ee0d628">resetBuffer</a>();             <span class="comment">// restore defaults</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="classAudioBuffer.html#a76035a22cd490fc6be361778a676aefc">   85</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code" href="classAudioBuffer.html#a76035a22cd490fc6be361778a676aefc">m_buffSizePSRAM</a> = 300000; <span class="comment">// most webstreams limit the advance to 100...300Kbytes</span></div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="classAudioBuffer.html#a00399a82f1a17158627d49048b986c61">   86</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code" href="classAudioBuffer.html#a00399a82f1a17158627d49048b986c61">m_buffSizeRAM</a>   = 1600 * 5;</div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="classAudioBuffer.html#a1ead2d31781e46ae5d0d44443f085e3a">   87</a></span>&#160;    <span class="keywordtype">size_t</span>       <a class="code" href="classAudioBuffer.html#a1ead2d31781e46ae5d0d44443f085e3a">m_buffSize</a>      = 0;</div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="classAudioBuffer.html#a204102fd96bbd43aa251a9151f3f046c">   88</a></span>&#160;    <span class="keywordtype">size_t</span>       <a class="code" href="classAudioBuffer.html#a204102fd96bbd43aa251a9151f3f046c">m_freeSpace</a>     = 0;</div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="classAudioBuffer.html#a3b74f3698f6336caf6d3461dca905026">   89</a></span>&#160;    <span class="keywordtype">size_t</span>       <a class="code" href="classAudioBuffer.html#a3b74f3698f6336caf6d3461dca905026">m_writeSpace</a>    = 0;</div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="classAudioBuffer.html#ab57d47e3b8427a25eff17b51214b3dab">   90</a></span>&#160;    <span class="keywordtype">size_t</span>       <a class="code" href="classAudioBuffer.html#ab57d47e3b8427a25eff17b51214b3dab">m_dataLength</a>    = 0;</div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="classAudioBuffer.html#a6addaa8685cbea8b38f7d76a457e2e3f">   91</a></span>&#160;    <span class="keywordtype">size_t</span>       <a class="code" href="classAudioBuffer.html#a6addaa8685cbea8b38f7d76a457e2e3f">m_resBuffSize</a>   = 1600; <span class="comment">// reserved buffspace, &gt;= one mp3 frame</span></div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="classAudioBuffer.html#a90e410087c28b27e2d23ed06da4e411b">   92</a></span>&#160;    uint8_t*     <a class="code" href="classAudioBuffer.html#a90e410087c28b27e2d23ed06da4e411b">m_buffer</a>        = NULL;</div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="classAudioBuffer.html#a921220f95bf7f4485357833d7abe0138">   93</a></span>&#160;    uint8_t*     <a class="code" href="classAudioBuffer.html#a921220f95bf7f4485357833d7abe0138">m_writePtr</a>      = NULL;</div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="classAudioBuffer.html#ad99673403200dd0456188d818349921a">   94</a></span>&#160;    uint8_t*     <a class="code" href="classAudioBuffer.html#ad99673403200dd0456188d818349921a">m_readPtr</a>       = NULL;</div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="classAudioBuffer.html#a40ff239c83186dbe8c79618e89161b1c">   95</a></span>&#160;    uint8_t*     <a class="code" href="classAudioBuffer.html#a40ff239c83186dbe8c79618e89161b1c">m_endPtr</a>        = NULL;</div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="classAudioBuffer.html#ace14cdc5e42f32594fe02771d358d30a">   96</a></span>&#160;    <span class="keywordtype">bool</span>         <a class="code" href="classAudioBuffer.html#ace14cdc5e42f32594fe02771d358d30a">m_f_start</a>       = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;};</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">//----------------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="AudioPlayer_8h.html#a29fb87c157a25d8b8ce6132b79319cf1">  100</a></span>&#160;<span class="keyword">typedef</span> void (*<a class="code" href="AudioPlayer_8h.html#a29fb87c157a25d8b8ce6132b79319cf1">AudioSampleFilter</a>)(<span class="keywordtype">unsigned</span> numBits, <span class="keywordtype">unsigned</span> numChannels, <span class="keyword">const</span> int16_t* samples, <span class="keywordtype">unsigned</span> sampleCount);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="classAudioPlayer.html">  102</a></span>&#160;<span class="keyword">class </span><a class="code" href="classAudioPlayer.html">AudioPlayer</a> : <span class="keyword">private</span> <a class="code" href="classAudioBuffer.html">AudioBuffer</a>{</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="classAudioBuffer.html">AudioBuffer</a> InBuff; <span class="comment">// instance of input buffer</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="classAudioPlayer.html#aa0545193648596a6e541fe964f16f902">AudioPlayer</a>(); <span class="comment">// #99</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <a class="code" href="classAudioPlayer.html#a41d5beac7ef47d2d935f17e822cbfd9f">~AudioPlayer</a>();</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classAudioPlayer.html#a6ab4815499a56ec3e7f58d718343282e">connecttoFS</a>(fs::FS &amp;fs, <span class="keyword">const</span> <span class="keywordtype">char</span>* file);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classAudioPlayer.html#a943ca4a43cf011fe35f391f7bd1536c8">connecttoSD</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* sdfile);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classAudioPlayer.html#acf647d41d83d6ee3dbbe52511d74af67">setFileLoop</a>(<span class="keywordtype">bool</span> input);<span class="comment">//TEST loop</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classAudioPlayer.html#ae4dc3a7e89a6f999eed7223836762491">connecttohost</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* host, <span class="keyword">const</span> <span class="keywordtype">char</span>* user = <span class="stringliteral">&quot;&quot;</span>, <span class="keyword">const</span> <span class="keywordtype">char</span>* pwd = <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classAudioPlayer.html#ab968a80744a8162bc061b7c7fe119e73">connecttospeech</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* speech, <span class="keyword">const</span> <span class="keywordtype">char</span>* lang);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classAudioPlayer.html#a25867f2bbe1cd6502c412937db6867fa">connecttonull</a>();</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classAudioPlayer.html#ac3165625c332eabee2d0b6eb7082ad82">loop</a>();</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    uint32_t <a class="code" href="classAudioPlayer.html#a7d29500a12f1d974d528f06947382813">getFileSize</a>();</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    uint32_t <a class="code" href="classAudioPlayer.html#a5d53ca20c45853e7a7a75e2d1681d90d">getFilePos</a>();</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    uint32_t <a class="code" href="classAudioPlayer.html#a71ae489659a06b677a1c669dd04878e0">getSampleRate</a>();</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    uint8_t  <a class="code" href="classAudioPlayer.html#a42a4124283947ab8ab807ff808c5a0b8">getBitsPerSample</a>();</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    uint8_t  <a class="code" href="classAudioPlayer.html#aa0fce6cee7ae415e3796b4c001d31db6">getChannels</a>();</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    uint32_t <a class="code" href="classAudioPlayer.html#ac99b66e1eaadc73ff070c292c0b33620">getAudioFileDuration</a>();</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    uint32_t <a class="code" href="classAudioPlayer.html#a2bcaeaccc3b8df04ace5dc5e16670551">getAudioCurrentTime</a>();</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classAudioPlayer.html#a597407e7416ef8eb227cff5fa16b52ff">setFilePos</a>(uint32_t pos);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classAudioPlayer.html#a64e38c95f8aba8d9b90c92d0a0a137a5">audioFileSeek</a>(<span class="keyword">const</span> int8_t speed);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classAudioPlayer.html#acfc3e5bbd9e29141c7167d2840ce4ca1">setPinout</a>(uint8_t BCLK, uint8_t LRC, uint8_t DOUT, int8_t DIN=I2S_PIN_NO_CHANGE);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classAudioPlayer.html#aac0f704251d6e06d9ef39ef5b83c010c">stopSong</a>();</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classAudioPlayer.html#a0d011d0f52f5265d3869e4a2bb96413d">pauseResume</a>();</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classAudioPlayer.html#aeab6dc1a9f52479c54aea9448996e551">forceMono</a>(<span class="keywordtype">bool</span> m);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classAudioPlayer.html#a1e7bf3d4986b3ab2138ffb2613d1d8ff">setBalance</a>(int8_t bal = 0);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classAudioPlayer.html#a7000040b58bc684fe47396c6e58bac6e">setVolume</a>(uint8_t vol);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    uint8_t <a class="code" href="classAudioPlayer.html#aa60190d73cc38b3a8b410c12742cca45">getVolume</a>();</div>
<div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="classAudioPlayer.html#a72a703eb29e69a7da9f6ad21ee566086">  156</a></span>&#160;    <span class="keyword">inline</span> uint8_t <a class="code" href="classAudioPlayer.html#a72a703eb29e69a7da9f6ad21ee566086">getDatamode</a>(){<span class="keywordflow">return</span> m_datamode;}</div>
<div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="classAudioPlayer.html#acb9edbcfd0516ee5de300759054b2616">  157</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classAudioPlayer.html#acb9edbcfd0516ee5de300759054b2616">setDatamode</a>(uint8_t dm){m_datamode=dm;}</div>
<div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="classAudioPlayer.html#a9db87a9e88c3bc257e50e501430c03cb">  158</a></span>&#160;    <span class="keyword">inline</span> uint32_t <a class="code" href="classAudioPlayer.html#a9db87a9e88c3bc257e50e501430c03cb">streamavail</a>() {<span class="keywordflow">if</span>(m_f_ssl==<span class="keyword">false</span>) <span class="keywordflow">return</span> client.available(); <span class="keywordflow">else</span> <span class="keywordflow">return</span> clientsecure.available();}</div>
<div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="classAudioPlayer.html#a653dc27d1d156f140f1aedf66c55b75e">  159</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classAudioPlayer.html#a653dc27d1d156f140f1aedf66c55b75e">isRunning</a>() {<span class="keywordflow">return</span> m_f_running;}</div>
<div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="classAudioPlayer.html#aaa3860db6331fd9109169f93a38bcb62">  160</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classAudioPlayer.html#aaa3860db6331fd9109169f93a38bcb62">isNullStream</a>() {<span class="keywordflow">return</span> m_f_nullstream;}</div>
<div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="classAudioPlayer.html#a1cff20640e56ad27a4f246552c4ac4cf">  161</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classAudioPlayer.html#a1cff20640e56ad27a4f246552c4ac4cf">isLocalFile</a>() {<span class="keywordflow">return</span> m_f_localfile;}</div>
<div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="classAudioPlayer.html#a07656ccdc4c05b7614b0db746ef0aeba">  162</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classAudioPlayer.html#a07656ccdc4c05b7614b0db746ef0aeba">isWebStream</a>() {<span class="keywordflow">return</span> m_f_webstream;}</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    esp_err_t <a class="code" href="classAudioPlayer.html#a5c947d742e7d08c0c7047067405d48e5">i2s_mclk_pin_select</a>(<span class="keyword">const</span> uint8_t pin);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    uint32_t <a class="code" href="classAudioPlayer.html#a39e8e14e1cecd1a24f6f1c3afe85034e">inBufferFilled</a>(); <span class="comment">// returns the number of stored bytes in the inputbuffer</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    uint32_t <a class="code" href="classAudioPlayer.html#ae635e904da40c3b739af57e56d5f7414">inBufferFree</a>();   <span class="comment">// returns the number of free bytes in the inputbuffer</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classAudioPlayer.html#aeb42faeba41bc2fdd8bcd7e6c5275169">setTone</a>(uint8_t l_type = 0, uint16_t l_freq = 0, uint8_t r_type = 0, uint16_t r_freq = 0);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classAudioPlayer.html#a48f5dfd4475a0687c32858bc9ec20d67">setInternalDAC</a>(<span class="keywordtype">bool</span> internalDAC);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classAudioPlayer.html#aa9f6213ec7eccdbe47ff34033e306b7f">setI2SCommFMT_LSB</a>(<span class="keywordtype">bool</span> commFMT);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="classAudioPlayer.html#aedee15dd444361668f7a1a73af2f89f0">  170</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classAudioPlayer.html#aedee15dd444361668f7a1a73af2f89f0">setSampleFilter</a>(<a class="code" href="AudioPlayer_8h.html#a29fb87c157a25d8b8ce6132b79319cf1">AudioSampleFilter</a> filter)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        sampleFilter = filter;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordtype">void</span> reset(); <span class="comment">// free buffers and set defaults</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordtype">void</span> initInBuff();</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordtype">void</span> processNullStream();</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordtype">void</span> processLocalFile();</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordtype">void</span> processWebStream();</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordtype">int</span>  sendBytes(uint8_t* data, <span class="keywordtype">size_t</span> len);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordtype">void</span> compute_audioCurrentTime(<span class="keywordtype">int</span> bd);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordtype">void</span> printDecodeError(<span class="keywordtype">int</span> r);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordtype">int</span>  readWaveHeader(uint8_t* data, <span class="keywordtype">size_t</span> len);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordtype">int</span>  readID3Metadata(uint8_t* data, <span class="keywordtype">size_t</span> len);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordtype">int</span>  readM4AContainer(uint8_t* data, <span class="keywordtype">size_t</span> len);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordtype">bool</span> setSampleRate(uint32_t hz);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordtype">bool</span> setBitsPerSample(<span class="keywordtype">int</span> bits);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordtype">bool</span> setChannels(<span class="keywordtype">int</span> channels);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordtype">bool</span> playChunk();</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordtype">bool</span> playSample(int16_t sample[2]) ;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordtype">bool</span> playI2Sremains();</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    int32_t Gain(int16_t s[2]);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordtype">bool</span> fill_InputBuf();</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordtype">void</span> showstreamtitle(<span class="keyword">const</span> <span class="keywordtype">char</span>* ml);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordtype">void</span> parsePlaylistData(<span class="keyword">const</span> <span class="keywordtype">char</span>* pd);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordtype">void</span> parseAudioHeader(<span class="keyword">const</span> <span class="keywordtype">char</span>* ah);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordtype">bool</span> parseContentType(<span class="keyword">const</span> <span class="keywordtype">char</span>* ct);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordtype">void</span> processControlData(uint8_t b);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    esp_err_t I2Sstart(uint8_t i2s_num);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    esp_err_t I2Sstop(uint8_t i2s_num);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    String urlencode(String str);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    int16_t* IIR_filterChain(int16_t iir_in[2], <span class="keywordtype">bool</span> clear = <span class="keyword">false</span>);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordtype">void</span> IIR_calculateCoefficients();</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">// implement several function with respect to the index of string</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordtype">bool</span> startsWith (<span class="keyword">const</span> <span class="keywordtype">char</span>* base, <span class="keyword">const</span> <span class="keywordtype">char</span>* str) { <span class="keywordflow">return</span> (strstr(base, str) - base) == 0;}</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordtype">bool</span> endsWith (<span class="keyword">const</span> <span class="keywordtype">char</span>* base, <span class="keyword">const</span> <span class="keywordtype">char</span>* str) {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="keywordtype">int</span> blen = strlen(base);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="keywordtype">int</span> slen = strlen(str);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="keywordflow">return</span> (blen &gt;= slen) &amp;&amp; (0 == strcmp(base + blen - slen, str));</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    }</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordtype">int</span> indexOf (<span class="keyword">const</span> <span class="keywordtype">char</span>* base, <span class="keyword">const</span> <span class="keywordtype">char</span>* str, <span class="keywordtype">int</span> startIndex) {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keywordtype">int</span> result;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keywordtype">int</span> baselen = strlen(base);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="keywordflow">if</span> (strlen(str) &gt; baselen || startIndex &gt; baselen) result = -1;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            <span class="keywordtype">char</span>* pos = strstr(base + startIndex, str);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            <span class="keywordflow">if</span> (pos == NULL) result = -1;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            <span class="keywordflow">else</span> result = pos - base;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordtype">int</span> specialIndexOf (uint8_t* base, <span class="keyword">const</span> <span class="keywordtype">char</span>* str, <span class="keywordtype">int</span> baselen){</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="keywordtype">int</span> result;  <span class="comment">// seek for str in buffer or in header up to baselen, not nullterninated</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordflow">if</span> (strlen(str) &gt; baselen) <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; baselen - strlen(str); i++){</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            result = i;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; strlen(str); j++){</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                <span class="keywordflow">if</span> (*(base + i + j) != *(str + j)){</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                    result = -1;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="keywordflow">if</span> (result &gt;= 0) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordtype">size_t</span> bigEndian(uint8_t* base, uint8_t numBytes){</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="keywordtype">size_t</span> result = 0;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keywordflow">if</span>(numBytes &lt; 1 or numBytes &gt; 4) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; numBytes; i++) {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                result += *(base + i) &lt;&lt; (numBytes -i - 1) * 8;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> audio_info(<span class="keyword">const</span> <span class="keywordtype">char</span> *info) {}</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> audio_id3data(<span class="keyword">const</span> <span class="keywordtype">char</span> *info) {}</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> audio_id3image(File&amp; file, <span class="keyword">const</span> <span class="keywordtype">size_t</span> pos, <span class="keyword">const</span> <span class="keywordtype">size_t</span> size) {}</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> audio_eof_mp3(<span class="keyword">const</span> <span class="keywordtype">char</span> *info) {}</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> audio_showstation(<span class="keyword">const</span> <span class="keywordtype">char</span> *info) {}</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> audio_showstreamtitle(<span class="keyword">const</span> <span class="keywordtype">char</span> *info) {}</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> audio_bitrate(<span class="keyword">const</span> <span class="keywordtype">char</span> *info) {}</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> audio_commercial(<span class="keyword">const</span> <span class="keywordtype">char</span> *info) {}</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> audio_icyurl(<span class="keyword">const</span> <span class="keywordtype">char</span> *info) {}</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> audio_lasthost(<span class="keyword">const</span> <span class="keywordtype">char</span> *info) {}</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> audio_eof_speech(<span class="keyword">const</span> <span class="keywordtype">char</span> *info) {}</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> audio_eof_stream(<span class="keyword">const</span> <span class="keywordtype">char</span>*) {}</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    enum : <span class="keywordtype">int</span> { APLL_AUTO = -1, APLL_ENABLE = 1, APLL_DISABLE = 0 };</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    enum : <span class="keywordtype">int</span> { EXTERNAL_I2S = 0, INTERNAL_DAC = 1, INTERNAL_PDM = 2 };</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    enum : <span class="keywordtype">int</span> { CODEC_NONE = 0, CODEC_WAV = 1, CODEC_MP3 = 2, CODEC_AAC = 4, CODEC_M4A = 5};</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    enum : <span class="keywordtype">int</span> { FORMAT_NONE = 0, FORMAT_M3U = 1, FORMAT_PLS = 2, FORMAT_ASX = 3};</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    enum : <span class="keywordtype">int</span> { AUDIO_NONE, AUDIO_HEADER , AUDIO_DATA, AUDIO_METADATA, AUDIO_PLAYLISTINIT,</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                 AUDIO_PLAYLISTHEADER,  AUDIO_PLAYLISTDATA, AUDIO_SWM };</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keyword">typedef</span> <span class="keyword">enum</span> { LEFTCHANNEL=0, RIGHTCHANNEL=1 } SampleIndex;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keyword">const</span> uint8_t volumetable[22]={   0,  1,  2,  3,  4 , 6 , 8, 10, 12, 14, 17,</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                                     20, 23, 27, 30 ,34, 38, 43 ,48, 52, 58, 64}; <span class="comment">//22 elements</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keyword">typedef</span> <span class="keyword">struct </span>_filter{</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keywordtype">float</span> a0;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="keywordtype">float</span> a1;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="keywordtype">float</span> a2;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="keywordtype">float</span> b1;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="keywordtype">float</span> b2;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    } filter_t;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    File              audiofile;    <span class="comment">// @suppress(&quot;Abstract class cannot be instantiated&quot;)</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    WiFiClient        client;       <span class="comment">// @suppress(&quot;Abstract class cannot be instantiated&quot;)</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    WiFiClientSecure  clientsecure; <span class="comment">// @suppress(&quot;Abstract class cannot be instantiated&quot;)</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    i2s_config_t      m_i2s_config; <span class="comment">// stores values for I2S driver</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    i2s_pin_config_t  m_pin_config;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <a class="code" href="AudioPlayer_8h.html#a29fb87c157a25d8b8ce6132b79319cf1">AudioSampleFilter</a> sampleFilter = NULL;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordtype">unsigned</span>          dummy = 0;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordtype">char</span>            chbuf[600];</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordtype">char</span>            path[256];</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordtype">char</span>            m_plsURL[256];                  <span class="comment">// URL found in playlist</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordtype">char</span>            m_lastHost[256];                <span class="comment">// Store the last URL to a webstream</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordtype">char</span>            m_audioName[256];               <span class="comment">// the name of the file</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    filter_t        m_filter[2];</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordtype">int</span>             m_id3Size=0;                    <span class="comment">// length id3 tag</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordtype">int</span>             m_LFcount = 0;                  <span class="comment">// Detection of end of header</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    uint32_t        m_sampleRate=16000;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordtype">int</span>             m_bytesLeft=0;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    uint32_t        m_bitRate=0;                    <span class="comment">// current bitrate given fom decoder</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    uint32_t        m_avr_bitrate = 0;              <span class="comment">// average bitrate, median computed by VBR</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordtype">int</span>             m_readbytes=0;                  <span class="comment">// bytes read</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordtype">int</span>             m_metalen=0;                    <span class="comment">// Number of bytes in metadata</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordtype">int</span>             m_controlCounter = 0;           <span class="comment">// Status within readID3data() and readWaveHeader()</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    int8_t          m_balance = 0;                  <span class="comment">// -16 (mute left) ... +16 (mute right)</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    uint8_t         m_ID3version=0;                 <span class="comment">// revision, ID3 version</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    uint8_t         m_vol=64;                       <span class="comment">// volume</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    uint8_t         m_bitsPerSample = 16;           <span class="comment">// bitsPerSample</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    uint8_t         m_channels=2;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    uint8_t         m_i2s_num = I2S_NUM_0;          <span class="comment">// I2S_NUM_0 or I2S_NUM_1</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    uint8_t         m_playlistFormat = 0;           <span class="comment">// M3U, PLS, ASX</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    uint8_t         m_codec = CODEC_NONE;           <span class="comment">//</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    uint8_t         m_filterType[2];                <span class="comment">// lowpass, highpass</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    int16_t         m_outBuff[2048*2];              <span class="comment">// [1152 * 2];          // Interleaved L/R</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    int16_t         m_validSamples = 0;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    int16_t         m_curSample = 0;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    uint16_t        m_st_remember = 0;              <span class="comment">// Save hash from the last streamtitle</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    uint16_t        m_datamode = 0;                 <span class="comment">// Statemaschine</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    uint32_t        m_metaint = 0;                  <span class="comment">// Number of databytes between metadata</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    uint32_t        m_totalcount = 0;               <span class="comment">// Counter mp3 data</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    uint32_t        m_chunkcount = 0 ;              <span class="comment">// Counter for chunked transfer</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    uint32_t        m_t0 = 0;                       <span class="comment">// store millis(), is needed for a small delay</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    uint32_t        m_metaCount = 0;                <span class="comment">// Bytecounter between metadata</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    uint32_t        m_contentlength = 0;            <span class="comment">// Stores the length if the stream comes from fileserver</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    uint32_t        m_bytectr = 0;                  <span class="comment">// count received data</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    uint32_t        m_bytesNotDecoded = 0;          <span class="comment">// pictures or something else that comes with the stream</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordtype">bool</span>            m_f_unsync = <span class="keyword">false</span>;             <span class="comment">// set within ID3 tag but not used</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordtype">bool</span>            m_f_exthdr = <span class="keyword">false</span>;             <span class="comment">// ID3 extended header</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordtype">bool</span>            m_f_localfile = false ;         <span class="comment">// Play from local mp3-file</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordtype">bool</span>            m_f_webstream = false ;         <span class="comment">// Play from URL</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordtype">bool</span>            m_f_nullstream = false ;        <span class="comment">// Play from null</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordtype">bool</span>            m_f_ssl = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordtype">bool</span>            m_f_running = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordtype">bool</span>            m_f_firststream_ready = <span class="keyword">false</span>;  <span class="comment">// Set after connecttohost and first streamdata are available</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordtype">bool</span>            m_f_ctseen = <span class="keyword">false</span>;             <span class="comment">// First line of header seen or not</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordtype">bool</span>            m_f_chunked = false ;           <span class="comment">// Station provides chunked transfer</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordtype">bool</span>            m_f_swm = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordtype">bool</span>            m_f_firstmetabyte = <span class="keyword">false</span>;      <span class="comment">// True if first metabyte (counter)</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordtype">bool</span>            m_f_stream = <span class="keyword">false</span>;             <span class="comment">// Set false if stream is lost</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordtype">bool</span>            m_f_playing = <span class="keyword">false</span>;            <span class="comment">// valid mp3 stream recognized</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordtype">bool</span>            m_f_webfile= <span class="keyword">false</span>;             <span class="comment">// assume it&#39;s a radiostream, not a podcast</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordtype">bool</span>            m_f_psram = <span class="keyword">false</span>;              <span class="comment">// set if PSRAM is availabe</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordtype">bool</span>            m_f_loop = <span class="keyword">false</span>;               <span class="comment">// Set if audio file should loop</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordtype">bool</span>            m_f_forceMono = <span class="keyword">false</span>;          <span class="comment">// if true stereo -&gt; mono</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordtype">bool</span>            m_f_internalDAC = <span class="keyword">false</span>;        <span class="comment">// false: output vis I2S, true output via internal DAC</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    uint32_t        m_audioFileDuration = 0;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordtype">float</span>           m_audioCurrentTime = 0;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordtype">float</span>           m_filterBuff[2][2][2];          <span class="comment">// IIR filters memory for Audio DSP</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordtype">size_t</span>          m_i2s_bytesWritten = 0;         <span class="comment">// set in i2s_write() but not used</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="keywordtype">size_t</span>          m_loop_point = 0;               <span class="comment">// Point in the file where the audio data starts</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordtype">size_t</span>          m_file_size = 0;                <span class="comment">// size of the file</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    uint16_t        m_filterFrequency[2];</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;};</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* AudioPlayer_h_ */</span><span class="preprocessor"></span></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aclassAudioPlayer_html_a25867f2bbe1cd6502c412937db6867fa"><div class="ttname"><a href="classAudioPlayer.html#a25867f2bbe1cd6502c412937db6867fa">AudioPlayer::connecttonull</a></div><div class="ttdeci">bool connecttonull()</div></div>
<div class="ttc" id="aclassAudioPlayer_html_a39e8e14e1cecd1a24f6f1c3afe85034e"><div class="ttname"><a href="classAudioPlayer.html#a39e8e14e1cecd1a24f6f1c3afe85034e">AudioPlayer::inBufferFilled</a></div><div class="ttdeci">uint32_t inBufferFilled()</div></div>
<div class="ttc" id="aclassAudioPlayer_html_a5c947d742e7d08c0c7047067405d48e5"><div class="ttname"><a href="classAudioPlayer.html#a5c947d742e7d08c0c7047067405d48e5">AudioPlayer::i2s_mclk_pin_select</a></div><div class="ttdeci">esp_err_t i2s_mclk_pin_select(const uint8_t pin)</div></div>
<div class="ttc" id="aclassAudioBuffer_html_a94d2e594082956eb129a9e1407322230"><div class="ttname"><a href="classAudioBuffer.html#a94d2e594082956eb129a9e1407322230">AudioBuffer::writePtr</a></div><div class="ttdeci">uint8_t * writePtr()</div></div>
<div class="ttc" id="aclassAudioPlayer_html_aaa3860db6331fd9109169f93a38bcb62"><div class="ttname"><a href="classAudioPlayer.html#aaa3860db6331fd9109169f93a38bcb62">AudioPlayer::isNullStream</a></div><div class="ttdeci">bool isNullStream()</div><div class="ttdef"><b>Definition:</b> AudioPlayer.h:160</div></div>
<div class="ttc" id="aclassAudioPlayer_html_aa0fce6cee7ae415e3796b4c001d31db6"><div class="ttname"><a href="classAudioPlayer.html#aa0fce6cee7ae415e3796b4c001d31db6">AudioPlayer::getChannels</a></div><div class="ttdeci">uint8_t getChannels()</div></div>
<div class="ttc" id="aclassAudioBuffer_html_a90e410087c28b27e2d23ed06da4e411b"><div class="ttname"><a href="classAudioBuffer.html#a90e410087c28b27e2d23ed06da4e411b">AudioBuffer::m_buffer</a></div><div class="ttdeci">uint8_t * m_buffer</div><div class="ttdef"><b>Definition:</b> AudioPlayer.h:92</div></div>
<div class="ttc" id="aclassAudioPlayer_html_a0d011d0f52f5265d3869e4a2bb96413d"><div class="ttname"><a href="classAudioPlayer.html#a0d011d0f52f5265d3869e4a2bb96413d">AudioPlayer::pauseResume</a></div><div class="ttdeci">bool pauseResume()</div><div class="ttdoc">pauseResume pauses current playback</div></div>
<div class="ttc" id="aclassAudioBuffer_html_a42323ac5a6c5ff9e46eb1c103a5b9630"><div class="ttname"><a href="classAudioBuffer.html#a42323ac5a6c5ff9e46eb1c103a5b9630">AudioBuffer::bufferFilled</a></div><div class="ttdeci">size_t bufferFilled()</div></div>
<div class="ttc" id="aclassAudioPlayer_html"><div class="ttname"><a href="classAudioPlayer.html">AudioPlayer</a></div><div class="ttdef"><b>Definition:</b> AudioPlayer.h:102</div></div>
<div class="ttc" id="aclassAudioPlayer_html_a5d53ca20c45853e7a7a75e2d1681d90d"><div class="ttname"><a href="classAudioPlayer.html#a5d53ca20c45853e7a7a75e2d1681d90d">AudioPlayer::getFilePos</a></div><div class="ttdeci">uint32_t getFilePos()</div></div>
<div class="ttc" id="aclassAudioPlayer_html_a7d29500a12f1d974d528f06947382813"><div class="ttname"><a href="classAudioPlayer.html#a7d29500a12f1d974d528f06947382813">AudioPlayer::getFileSize</a></div><div class="ttdeci">uint32_t getFileSize()</div></div>
<div class="ttc" id="aclassAudioPlayer_html_acf647d41d83d6ee3dbbe52511d74af67"><div class="ttname"><a href="classAudioPlayer.html#acf647d41d83d6ee3dbbe52511d74af67">AudioPlayer::setFileLoop</a></div><div class="ttdeci">bool setFileLoop(bool input)</div></div>
<div class="ttc" id="aclassAudioPlayer_html_a2bcaeaccc3b8df04ace5dc5e16670551"><div class="ttname"><a href="classAudioPlayer.html#a2bcaeaccc3b8df04ace5dc5e16670551">AudioPlayer::getAudioCurrentTime</a></div><div class="ttdeci">uint32_t getAudioCurrentTime()</div><div class="ttdoc">Get the current plying time in seconds.</div></div>
<div class="ttc" id="aclassAudioPlayer_html_ac3165625c332eabee2d0b6eb7082ad82"><div class="ttname"><a href="classAudioPlayer.html#ac3165625c332eabee2d0b6eb7082ad82">AudioPlayer::loop</a></div><div class="ttdeci">void loop()</div></div>
<div class="ttc" id="aclassAudioPlayer_html_a943ca4a43cf011fe35f391f7bd1536c8"><div class="ttname"><a href="classAudioPlayer.html#a943ca4a43cf011fe35f391f7bd1536c8">AudioPlayer::connecttoSD</a></div><div class="ttdeci">bool connecttoSD(const char *sdfile)</div></div>
<div class="ttc" id="aclassAudioPlayer_html_aa9f6213ec7eccdbe47ff34033e306b7f"><div class="ttname"><a href="classAudioPlayer.html#aa9f6213ec7eccdbe47ff34033e306b7f">AudioPlayer::setI2SCommFMT_LSB</a></div><div class="ttdeci">void setI2SCommFMT_LSB(bool commFMT)</div></div>
<div class="ttc" id="aAudioPlayer_8h_html_a29fb87c157a25d8b8ce6132b79319cf1"><div class="ttname"><a href="AudioPlayer_8h.html#a29fb87c157a25d8b8ce6132b79319cf1">AudioSampleFilter</a></div><div class="ttdeci">void(* AudioSampleFilter)(unsigned numBits, unsigned numChannels, const int16_t *samples, unsigned sampleCount)</div><div class="ttdef"><b>Definition:</b> AudioPlayer.h:100</div></div>
<div class="ttc" id="aclassAudioPlayer_html_ae4dc3a7e89a6f999eed7223836762491"><div class="ttname"><a href="classAudioPlayer.html#ae4dc3a7e89a6f999eed7223836762491">AudioPlayer::connecttohost</a></div><div class="ttdeci">bool connecttohost(const char *host, const char *user=&quot;&quot;, const char *pwd=&quot;&quot;)</div></div>
<div class="ttc" id="aclassAudioPlayer_html_a6ab4815499a56ec3e7f58d718343282e"><div class="ttname"><a href="classAudioPlayer.html#a6ab4815499a56ec3e7f58d718343282e">AudioPlayer::connecttoFS</a></div><div class="ttdeci">bool connecttoFS(fs::FS &amp;fs, const char *file)</div></div>
<div class="ttc" id="aclassAudioBuffer_html_ab57d47e3b8427a25eff17b51214b3dab"><div class="ttname"><a href="classAudioBuffer.html#ab57d47e3b8427a25eff17b51214b3dab">AudioBuffer::m_dataLength</a></div><div class="ttdeci">size_t m_dataLength</div><div class="ttdef"><b>Definition:</b> AudioPlayer.h:90</div></div>
<div class="ttc" id="aclassAudioPlayer_html_ae635e904da40c3b739af57e56d5f7414"><div class="ttname"><a href="classAudioPlayer.html#ae635e904da40c3b739af57e56d5f7414">AudioPlayer::inBufferFree</a></div><div class="ttdeci">uint32_t inBufferFree()</div></div>
<div class="ttc" id="aclassAudioBuffer_html_a76035a22cd490fc6be361778a676aefc"><div class="ttname"><a href="classAudioBuffer.html#a76035a22cd490fc6be361778a676aefc">AudioBuffer::m_buffSizePSRAM</a></div><div class="ttdeci">const size_t m_buffSizePSRAM</div><div class="ttdef"><b>Definition:</b> AudioPlayer.h:85</div></div>
<div class="ttc" id="aclassAudioBuffer_html_a7714f5ad92756b53a6f95ca97b6fd8ff"><div class="ttname"><a href="classAudioBuffer.html#a7714f5ad92756b53a6f95ca97b6fd8ff">AudioBuffer::writeSpace</a></div><div class="ttdeci">size_t writeSpace()</div></div>
<div class="ttc" id="aclassAudioPlayer_html_a71ae489659a06b677a1c669dd04878e0"><div class="ttname"><a href="classAudioPlayer.html#a71ae489659a06b677a1c669dd04878e0">AudioPlayer::getSampleRate</a></div><div class="ttdeci">uint32_t getSampleRate()</div></div>
<div class="ttc" id="aclassAudioPlayer_html_aa0545193648596a6e541fe964f16f902"><div class="ttname"><a href="classAudioPlayer.html#aa0545193648596a6e541fe964f16f902">AudioPlayer::AudioPlayer</a></div><div class="ttdeci">AudioPlayer()</div></div>
<div class="ttc" id="aclassAudioPlayer_html_a597407e7416ef8eb227cff5fa16b52ff"><div class="ttname"><a href="classAudioPlayer.html#a597407e7416ef8eb227cff5fa16b52ff">AudioPlayer::setFilePos</a></div><div class="ttdeci">bool setFilePos(uint32_t pos)</div></div>
<div class="ttc" id="aclassAudioBuffer_html_a1ead2d31781e46ae5d0d44443f085e3a"><div class="ttname"><a href="classAudioBuffer.html#a1ead2d31781e46ae5d0d44443f085e3a">AudioBuffer::m_buffSize</a></div><div class="ttdeci">size_t m_buffSize</div><div class="ttdef"><b>Definition:</b> AudioPlayer.h:87</div></div>
<div class="ttc" id="aclassAudioPlayer_html_a48f5dfd4475a0687c32858bc9ec20d67"><div class="ttname"><a href="classAudioPlayer.html#a48f5dfd4475a0687c32858bc9ec20d67">AudioPlayer::setInternalDAC</a></div><div class="ttdeci">void setInternalDAC(bool internalDAC)</div></div>
<div class="ttc" id="aclassAudioPlayer_html_aedee15dd444361668f7a1a73af2f89f0"><div class="ttname"><a href="classAudioPlayer.html#aedee15dd444361668f7a1a73af2f89f0">AudioPlayer::setSampleFilter</a></div><div class="ttdeci">void setSampleFilter(AudioSampleFilter filter)</div><div class="ttdef"><b>Definition:</b> AudioPlayer.h:170</div></div>
<div class="ttc" id="aclassAudioBuffer_html_aef8f9eb21f4d58339eab5b0e05b27fae"><div class="ttname"><a href="classAudioBuffer.html#aef8f9eb21f4d58339eab5b0e05b27fae">AudioBuffer::freeSpace</a></div><div class="ttdeci">size_t freeSpace()</div></div>
<div class="ttc" id="aclassAudioBuffer_html_ad0ac8e7a12eebe66c317683d94b3707e"><div class="ttname"><a href="classAudioBuffer.html#ad0ac8e7a12eebe66c317683d94b3707e">AudioBuffer::~AudioBuffer</a></div><div class="ttdeci">~AudioBuffer()</div></div>
<div class="ttc" id="aclassAudioPlayer_html_acb9edbcfd0516ee5de300759054b2616"><div class="ttname"><a href="classAudioPlayer.html#acb9edbcfd0516ee5de300759054b2616">AudioPlayer::setDatamode</a></div><div class="ttdeci">void setDatamode(uint8_t dm)</div><div class="ttdef"><b>Definition:</b> AudioPlayer.h:157</div></div>
<div class="ttc" id="aclassAudioPlayer_html_a653dc27d1d156f140f1aedf66c55b75e"><div class="ttname"><a href="classAudioPlayer.html#a653dc27d1d156f140f1aedf66c55b75e">AudioPlayer::isRunning</a></div><div class="ttdeci">bool isRunning()</div><div class="ttdef"><b>Definition:</b> AudioPlayer.h:159</div></div>
<div class="ttc" id="aclassAudioPlayer_html_a72a703eb29e69a7da9f6ad21ee566086"><div class="ttname"><a href="classAudioPlayer.html#a72a703eb29e69a7da9f6ad21ee566086">AudioPlayer::getDatamode</a></div><div class="ttdeci">uint8_t getDatamode()</div><div class="ttdef"><b>Definition:</b> AudioPlayer.h:156</div></div>
<div class="ttc" id="aclassAudioPlayer_html_a9db87a9e88c3bc257e50e501430c03cb"><div class="ttname"><a href="classAudioPlayer.html#a9db87a9e88c3bc257e50e501430c03cb">AudioPlayer::streamavail</a></div><div class="ttdeci">uint32_t streamavail()</div><div class="ttdef"><b>Definition:</b> AudioPlayer.h:158</div></div>
<div class="ttc" id="aclassAudioBuffer_html_a771e25dbef713d81d4e9ffc543405172"><div class="ttname"><a href="classAudioBuffer.html#a771e25dbef713d81d4e9ffc543405172">AudioBuffer::readPtr</a></div><div class="ttdeci">uint8_t * readPtr()</div></div>
<div class="ttc" id="aclassAudioBuffer_html_ace14cdc5e42f32594fe02771d358d30a"><div class="ttname"><a href="classAudioBuffer.html#ace14cdc5e42f32594fe02771d358d30a">AudioBuffer::m_f_start</a></div><div class="ttdeci">bool m_f_start</div><div class="ttdef"><b>Definition:</b> AudioPlayer.h:96</div></div>
<div class="ttc" id="aclassAudioPlayer_html_a41d5beac7ef47d2d935f17e822cbfd9f"><div class="ttname"><a href="classAudioPlayer.html#a41d5beac7ef47d2d935f17e822cbfd9f">AudioPlayer::~AudioPlayer</a></div><div class="ttdeci">~AudioPlayer()</div></div>
<div class="ttc" id="aclassAudioPlayer_html_ac99b66e1eaadc73ff070c292c0b33620"><div class="ttname"><a href="classAudioPlayer.html#ac99b66e1eaadc73ff070c292c0b33620">AudioPlayer::getAudioFileDuration</a></div><div class="ttdeci">uint32_t getAudioFileDuration()</div><div class="ttdoc">Get the audio file duration in seconds.</div></div>
<div class="ttc" id="aclassAudioBuffer_html_aabaf555275e703fb89bd766c599ec625"><div class="ttname"><a href="classAudioBuffer.html#aabaf555275e703fb89bd766c599ec625">AudioBuffer::bytesWritten</a></div><div class="ttdeci">void bytesWritten(size_t bw)</div></div>
<div class="ttc" id="aclassAudioPlayer_html_a64e38c95f8aba8d9b90c92d0a0a137a5"><div class="ttname"><a href="classAudioPlayer.html#a64e38c95f8aba8d9b90c92d0a0a137a5">AudioPlayer::audioFileSeek</a></div><div class="ttdeci">bool audioFileSeek(const int8_t speed)</div><div class="ttdoc">audioFileSeek seeks the file in both directions</div></div>
<div class="ttc" id="aclassAudioBuffer_html_a00399a82f1a17158627d49048b986c61"><div class="ttname"><a href="classAudioBuffer.html#a00399a82f1a17158627d49048b986c61">AudioBuffer::m_buffSizeRAM</a></div><div class="ttdeci">const size_t m_buffSizeRAM</div><div class="ttdef"><b>Definition:</b> AudioPlayer.h:86</div></div>
<div class="ttc" id="aclassAudioPlayer_html_aa60190d73cc38b3a8b410c12742cca45"><div class="ttname"><a href="classAudioPlayer.html#aa60190d73cc38b3a8b410c12742cca45">AudioPlayer::getVolume</a></div><div class="ttdeci">uint8_t getVolume()</div></div>
<div class="ttc" id="aclassAudioPlayer_html_a7000040b58bc684fe47396c6e58bac6e"><div class="ttname"><a href="classAudioPlayer.html#a7000040b58bc684fe47396c6e58bac6e">AudioPlayer::setVolume</a></div><div class="ttdeci">void setVolume(uint8_t vol)</div></div>
<div class="ttc" id="aclassAudioPlayer_html_a07656ccdc4c05b7614b0db746ef0aeba"><div class="ttname"><a href="classAudioPlayer.html#a07656ccdc4c05b7614b0db746ef0aeba">AudioPlayer::isWebStream</a></div><div class="ttdeci">bool isWebStream()</div><div class="ttdef"><b>Definition:</b> AudioPlayer.h:162</div></div>
<div class="ttc" id="aclassAudioBuffer_html_a6addaa8685cbea8b38f7d76a457e2e3f"><div class="ttname"><a href="classAudioBuffer.html#a6addaa8685cbea8b38f7d76a457e2e3f">AudioBuffer::m_resBuffSize</a></div><div class="ttdeci">size_t m_resBuffSize</div><div class="ttdef"><b>Definition:</b> AudioPlayer.h:91</div></div>
<div class="ttc" id="aclassAudioBuffer_html_ad99673403200dd0456188d818349921a"><div class="ttname"><a href="classAudioBuffer.html#ad99673403200dd0456188d818349921a">AudioBuffer::m_readPtr</a></div><div class="ttdeci">uint8_t * m_readPtr</div><div class="ttdef"><b>Definition:</b> AudioPlayer.h:94</div></div>
<div class="ttc" id="aclassAudioPlayer_html_acfc3e5bbd9e29141c7167d2840ce4ca1"><div class="ttname"><a href="classAudioPlayer.html#acfc3e5bbd9e29141c7167d2840ce4ca1">AudioPlayer::setPinout</a></div><div class="ttdeci">bool setPinout(uint8_t BCLK, uint8_t LRC, uint8_t DOUT, int8_t DIN=I2S_PIN_NO_CHANGE)</div></div>
<div class="ttc" id="aclassAudioPlayer_html_aac0f704251d6e06d9ef39ef5b83c010c"><div class="ttname"><a href="classAudioPlayer.html#aac0f704251d6e06d9ef39ef5b83c010c">AudioPlayer::stopSong</a></div><div class="ttdeci">void stopSong()</div></div>
<div class="ttc" id="aclassAudioBuffer_html_a204102fd96bbd43aa251a9151f3f046c"><div class="ttname"><a href="classAudioBuffer.html#a204102fd96bbd43aa251a9151f3f046c">AudioBuffer::m_freeSpace</a></div><div class="ttdeci">size_t m_freeSpace</div><div class="ttdef"><b>Definition:</b> AudioPlayer.h:88</div></div>
<div class="ttc" id="aclassAudioPlayer_html_ab968a80744a8162bc061b7c7fe119e73"><div class="ttname"><a href="classAudioPlayer.html#ab968a80744a8162bc061b7c7fe119e73">AudioPlayer::connecttospeech</a></div><div class="ttdeci">bool connecttospeech(const char *speech, const char *lang)</div></div>
<div class="ttc" id="aclassAudioBuffer_html_a41f2d6df57df4b4842908ed8465dbd1b"><div class="ttname"><a href="classAudioBuffer.html#a41f2d6df57df4b4842908ed8465dbd1b">AudioBuffer::bytesWasRead</a></div><div class="ttdeci">void bytesWasRead(size_t br)</div></div>
<div class="ttc" id="aclassAudioPlayer_html_aeb42faeba41bc2fdd8bcd7e6c5275169"><div class="ttname"><a href="classAudioPlayer.html#aeb42faeba41bc2fdd8bcd7e6c5275169">AudioPlayer::setTone</a></div><div class="ttdeci">void setTone(uint8_t l_type=0, uint16_t l_freq=0, uint8_t r_type=0, uint16_t r_freq=0)</div></div>
<div class="ttc" id="aclassAudioBuffer_html_a4db6ca32d7db0d2d6ed2463e6b28da51"><div class="ttname"><a href="classAudioBuffer.html#a4db6ca32d7db0d2d6ed2463e6b28da51">AudioBuffer::getWritePos</a></div><div class="ttdeci">uint32_t getWritePos()</div></div>
<div class="ttc" id="aclassAudioBuffer_html"><div class="ttname"><a href="classAudioBuffer.html">AudioBuffer</a></div><div class="ttdef"><b>Definition:</b> AudioPlayer.h:42</div></div>
<div class="ttc" id="aclassAudioBuffer_html_a3b74f3698f6336caf6d3461dca905026"><div class="ttname"><a href="classAudioBuffer.html#a3b74f3698f6336caf6d3461dca905026">AudioBuffer::m_writeSpace</a></div><div class="ttdeci">size_t m_writeSpace</div><div class="ttdef"><b>Definition:</b> AudioPlayer.h:89</div></div>
<div class="ttc" id="aclassAudioBuffer_html_a4c3ac9edee009fefbe8584290d40464c"><div class="ttname"><a href="classAudioBuffer.html#a4c3ac9edee009fefbe8584290d40464c">AudioBuffer::getReadPos</a></div><div class="ttdeci">uint32_t getReadPos()</div></div>
<div class="ttc" id="aclassAudioBuffer_html_a40ff239c83186dbe8c79618e89161b1c"><div class="ttname"><a href="classAudioBuffer.html#a40ff239c83186dbe8c79618e89161b1c">AudioBuffer::m_endPtr</a></div><div class="ttdeci">uint8_t * m_endPtr</div><div class="ttdef"><b>Definition:</b> AudioPlayer.h:95</div></div>
<div class="ttc" id="aclassAudioPlayer_html_a42a4124283947ab8ab807ff808c5a0b8"><div class="ttname"><a href="classAudioPlayer.html#a42a4124283947ab8ab807ff808c5a0b8">AudioPlayer::getBitsPerSample</a></div><div class="ttdeci">uint8_t getBitsPerSample()</div></div>
<div class="ttc" id="aclassAudioBuffer_html_aba78f7f67592d21765d202c5f73303ba"><div class="ttname"><a href="classAudioBuffer.html#aba78f7f67592d21765d202c5f73303ba">AudioBuffer::AudioBuffer</a></div><div class="ttdeci">AudioBuffer()</div></div>
<div class="ttc" id="aclassAudioBuffer_html_a921220f95bf7f4485357833d7abe0138"><div class="ttname"><a href="classAudioBuffer.html#a921220f95bf7f4485357833d7abe0138">AudioBuffer::m_writePtr</a></div><div class="ttdeci">uint8_t * m_writePtr</div><div class="ttdef"><b>Definition:</b> AudioPlayer.h:93</div></div>
<div class="ttc" id="aclassAudioPlayer_html_a1e7bf3d4986b3ab2138ffb2613d1d8ff"><div class="ttname"><a href="classAudioPlayer.html#a1e7bf3d4986b3ab2138ffb2613d1d8ff">AudioPlayer::setBalance</a></div><div class="ttdeci">void setBalance(int8_t bal=0)</div></div>
<div class="ttc" id="aclassAudioPlayer_html_aeab6dc1a9f52479c54aea9448996e551"><div class="ttname"><a href="classAudioPlayer.html#aeab6dc1a9f52479c54aea9448996e551">AudioPlayer::forceMono</a></div><div class="ttdeci">void forceMono(bool m)</div></div>
<div class="ttc" id="aclassAudioBuffer_html_a16f25a4e620cb6b7b27bc7834ee0d628"><div class="ttname"><a href="classAudioBuffer.html#a16f25a4e620cb6b7b27bc7834ee0d628">AudioBuffer::resetBuffer</a></div><div class="ttdeci">void resetBuffer()</div></div>
<div class="ttc" id="aclassAudioBuffer_html_a1cd827716f4f84c3f009bee37d5a5cf4"><div class="ttname"><a href="classAudioBuffer.html#a1cd827716f4f84c3f009bee37d5a5cf4">AudioBuffer::init</a></div><div class="ttdeci">size_t init(size_t bufSize=0)</div></div>
<div class="ttc" id="aclassAudioPlayer_html_a1cff20640e56ad27a4f246552c4ac4cf"><div class="ttname"><a href="classAudioPlayer.html#a1cff20640e56ad27a4f246552c4ac4cf">AudioPlayer::isLocalFile</a></div><div class="ttdeci">bool isLocalFile()</div><div class="ttdef"><b>Definition:</b> AudioPlayer.h:161</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_a63dedf81f1e5ea1d42bb45ef831eb8c.html">audio</a></li><li class="navelem"><a class="el" href="AudioPlayer_8h.html">AudioPlayer.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
